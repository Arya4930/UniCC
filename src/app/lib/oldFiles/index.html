<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Weekly Attendance</title>
    <style>
        body {
            font-family: Arial;
            background: #f4f6f8;
            margin: 20px;
        }

        h1 {
            text-align: center;
        }

        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tabs button {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            background: #ddd;
            font-weight: bold;
        }

        .tabs button.active {
            background: #3498db;
            color: white;
        }

        .tab-content {
            display: none;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .tab-content.active {
            display: grid;
        }

        .card {
            background: white;
            padding: 15px;
            border-radius: 12px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .card h3 {
            margin: 0 0 8px;
            font-size: 16px;
            color: #2c3e50;
        }

        .detail {
            margin: 4px 0;
            font-size: 14px;
            color: #444;
        }

        .attendance {
            font-weight: bold;
            margin-top: 6px;
        }

        .low {
            color: red;
        }

        .medium {
            color: orange;
        }

        .high {
            color: green;
        }

        .tab-content {
            display: none;
            flex-direction: column;
            /* stack cards vertically */
            gap: 20px;
        }

        .tab-content.active {
            display: flex;
        }

        .card {
            width: 100vw;
            /* full viewport width */
            box-sizing: border-box;
            padding: 30px;
        }
    </style>
</head>

<body>
    <h1>Weekly Attendance Slots</h1>
    <div class="tabs">
        <button class="tab-btn active" data-day="MON">Monday</button>
        <button class="tab-btn" data-day="TUE">Tuesday</button>
        <button class="tab-btn" data-day="WED">Wednesday</button>
        <button class="tab-btn" data-day="THU">Thursday</button>
        <button class="tab-btn" data-day="FRI">Friday</button>
    </div>
    <div id="MON" class="tab-content active"></div>
    <div id="TUE" class="tab-content"></div>
    <div id="WED" class="tab-content"></div>
    <div id="THU" class="tab-content"></div>
    <div id="FRI" class="tab-content"></div>

    <script>
        // Corrected slot map with proper day assignments
        const slotMap = {
            MON: {
                A1: { time: "8:00-8:50" }, F1: { time: "8:55-9:45" }, D1: { time: "9:50-10:40" },
                TB1: { time: "10:45-11:35" }, TG1: { time: "11:40-12:30" }, S11: { time: "12:35-1:25" },
                A2: { time: "2:00-2:50" }, F2: { time: "2:55-3:45" }, D2: { time: "3:50-4:40" },
                TB2: { time: "4:45-5:35" }, TG2: { time: "5:40-6:30" }, S3: { time: "6:35-7:25" },
                L1: { time: "8:00-8:50" }, L2: { time: "8:50-9:40" }, L3: { time: "9:50-10:40" },
                L4: { time: "10:40-11:30" }, L5: { time: "11:40-12:30" }, L6: { time: "12:30-1:20" },
                L31: { time: "2:00-2:50" }, L32: { time: "2:50-3:40" }, L33: { time: "3:50-4:40" },
                L34: { time: "4:40-5:30" }, L35: { time: "5:40-6:30" }, L36: { time: "6:30-7:20" }
            },
            TUE: {
                B1: { time: "8:00-8:50" }, G1: { time: "8:55-9:45" }, E1: { time: "9:50-10:40" },
                TC1: { time: "10:45-11:35" }, TAA1: { time: "11:40-12:30" }, L12: { time: "12:35-1:25" },
                B2: { time: "2:00-2:50" }, G2: { time: "2:55-3:45" }, E2: { time: "3:50-4:40" },
                TC2: { time: "4:45-5:35" }, TAA2: { time: "5:40-6:30" }, S1: { time: "6:35-7:25" },
                L7: { time: "8:00-8:50" }, L8: { time: "8:50-9:40" }, L9: { time: "9:50-10:40" },
                L10: { time: "10:40-11:30" }, L11: { time: "11:40-12:30" }, L37: { time: "2:00-2:50" },
                L38: { time: "2:50-3:40" }, L39: { time: "3:50-4:40" }, L40: { time: "4:40-5:30" },
                L41: { time: "5:40-6:30" }, L42: { time: "6:30-7:20" }
            },
            WED: {
                C1: { time: "8:00-8:50" }, A1: { time: "8:55-9:45" }, F1: { time: "9:50-10:40" },
                TD1: { time: "10:45-11:35" }, TBB1: { time: "11:40-12:30" }, L18: { time: "12:35-1:25" },
                C2: { time: "2:00-2:50" }, A2: { time: "2:55-3:45" }, F2: { time: "3:50-4:40" },
                TD2: { time: "4:45-5:35" }, TBB2: { time: "5:40-6:30" }, S4: { time: "6:35-7:25" },
                L12: { time: "8:00-8:50" }, L13: { time: "8:50-9:40" }, L14: { time: "9:50-10:40" },
                L15: { time: "10:40-11:30" }, L17: { time: "11:40-12:30" }, L43: { time: "2:00-2:50" },
                L44: { time: "2:50-3:40" }, L45: { time: "3:50-4:40" }, L46: { time: "4:40-5:30" },
                L47: { time: "5:40-6:30" }, L48: { time: "6:30-7:20" }
            },
            THU: {
                D1: { time: "8:00-8:50" }, B1: { time: "8:55-9:45" }, G1: { time: "9:50-10:40" },
                TE1: { time: "10:45-11:35" }, TCC1: { time: "11:40-12:30" }, L24: { time: "12:35-1:25" },
                D2: { time: "2:00-2:50" }, B2: { time: "2:55-3:45" }, G2: { time: "3:50-4:40" },
                TE2: { time: "4:45-5:35" }, TCC2: { time: "5:40-6:30" }, S2: { time: "6:35-7:25" },
                L19: { time: "8:00-8:50" }, L20: { time: "8:50-9:40" }, L21: { time: "9:50-10:40" },
                L22: { time: "10:40-11:30" }, L23: { time: "11:40-12:30" }, L49: { time: "2:00-2:50" },
                L50: { time: "2:50-3:40" }, L51: { time: "3:50-4:40" }, L52: { time: "4:40-5:30" },
                L53: { time: "5:40-6:30" }, L54: { time: "6:30-7:20" }
            },
            FRI: {
                E1: { time: "8:00-8:50" }, C1: { time: "8:55-9:45" }, TA1: { time: "9:50-10:40" },
                TF1: { time: "10:45-11:35" }, TDD1: { time: "11:40-12:30" }, S15: { time: "12:35-1:25" },
                E2: { time: "2:00-2:50" }, C2: { time: "2:55-3:45" }, TA2: { time: "3:50-4:40" },
                TF2: { time: "4:45-5:35" }, TDD2: { time: "5:40-6:30" }, L60: { time: "6:35-7:25" },
                L25: { time: "8:00-8:50" }, L26: { time: "8:50-9:40" }, L27: { time: "9:50-10:40" },
                L28: { time: "10:40-11:30" }, L29: { time: "11:40-12:30" }, L30: { time: "12:30-1:20" },
                L55: { time: "2:00-2:50" }, L56: { time: "2:50-3:40" }, L57: { time: "3:50-4:40" },
                L58: { time: "4:40-5:30" }, L59: { time: "5:40-6:30" }
            }
        };


        // Function to load and display attendance
        async function loadAttendance() {
            const attendance = await fetch("attendance.json");
            const attendanceData = await attendance.json();

            // Create a map for each day to hold cards before appending
            const dayCardsMap = {
                MON: [], TUE: [], WED: [], THU: [], FRI: []
            };

            attendanceData.attendance.forEach(a => {
                const slots = a.slot.split("+");

                slots.forEach(slotName => {
                    const cleanSlot = slotName.trim();

                    for (const day in slotMap) {
                        if (slotMap[day][cleanSlot]) {
                            const info = slotMap[day][cleanSlot];
                            const pct = parseInt(a.attendancePercentage);
                            let cls = pct < 50 ? "low" : pct < 75 ? "medium" : "high";

                            const card = document.createElement("div");
                            card.className = "card";
                            card.dataset.time = info.time; // store time for sorting
                            card.innerHTML = `
                        <h3>Slot: ${cleanSlot}</h3>
                        <div class="detail"><strong>Course:</strong> ${a.courseTitle} (${a.courseType})</div>
                        <div class="detail"><strong>Faculty:</strong> ${a.faculty}</div>
                        <div class="detail"><strong>Time:</strong> ${info.time}</div>
                        <div class="attendance ${cls}">Attendance: ${a.attendedClasses}/${a.totalClasses} (${pct}%)</div>
                    `;
                            dayCardsMap[day].push(card);
                        }
                    }
                });
            });

            // Append cards to each day sorted by start time
            for (const day in dayCardsMap) {
                const container = document.getElementById(day);
                dayCardsMap[day]
                    .sort((a, b) => {
                        const slotA = a.querySelector("h3").innerText.split(" ")[1];
                        const slotB = b.querySelector("h3").innerText.split(" ")[1];

                        const isMorningA = /[A-Z]1$|L([1-2]?[0-9]|30)$/.test(slotA);
                        const isMorningB = /[A-Z]1$|L([1-2]?[0-9]|30)$/.test(slotB);

                        if (isMorningA && !isMorningB) return -1;
                        if (!isMorningA && isMorningB) return 1;

                        // optional: sort by slot name within morning/evening
                        return slotA.localeCompare(slotB);
                    })
                    .forEach(card => container.appendChild(card));
            }
        }

        // Helper to convert HH:MM to minutes
        function parseTime(timeStr) {
            const [h, m] = timeStr.split(":").map(Number);
            return h * 60 + m;
        }

        // Tab switching functionality
        function setupTabs() {
            document.querySelectorAll(".tab-btn").forEach(btn => {
                btn.addEventListener("click", () => {
                    // Remove active class from all buttons and tabs
                    document.querySelectorAll(".tab-btn").forEach(b => b.classList.remove("active"));
                    document.querySelectorAll(".tab-content").forEach(tab => tab.classList.remove("active"));

                    // Add active class to clicked button and corresponding tab
                    btn.classList.add("active");
                    document.getElementById(btn.dataset.day).classList.add("active");
                });
            });
        }

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function () {
            setupTabs();
            loadAttendance();
        });
    </script>
</body>

</html>